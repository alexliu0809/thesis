\section{Discussion and Future Work}
% Things I'd like to mention:   
    % Challenges in identifying the amount
    % Benefits of the new architecture

\label{sec:discuss}
% \alex{add more sections. e.g., add-on}
Our work is a ``first cut'' at identifying, validating and implementing a
generic mode of theft protection into cross-chain transactions. I show that a
simple balance invariant is sufficient to detect and prevent most bridge
attacks. Our effort also highlights the need for better auditability and
auditing in the bridge ecosystem, and for new bridge designs.  Indeed, deploying a cross-chain token bridge with an in-line balance invariant
monitor is an open challenge.

As mentioned in Section~\ref{sec:background}, in this chapter I focus on
cross-chain token bridges and thus our approach does not directly apply to
bridges that have built-in exchanges and swaps.  Still, similar
invariant-checking techniques likely extend to such \emph{cross-chain exchanges}
and similar protocols (e.g., Automated Market Makers which trade between a
range of cryptocurrencies in decentralized exchanges). Such extensions will
require incorporating contemporaneous price oracle data
into our framework
and addition reasoning.
% I leave this to future work.

The larger opportunities opened up by this work are
more architectural.  Today, when a crypto platform declares that their
system has been audited, they typically are referring to a third-party
that inspects their smart contracts for common logic errors or
deficiencies in their process.  Any validation of overall financial
safety is inherently entwined with the totality of the implementation.
However, such code-oriented audits are inherently challenging and
ill-suited for overarching questions of financial risk.  They must
evaluate all contracts and bridge code that directly or indirectly
have access to keys controlling assets and then must ensure that no
combination of inputs or invocations might lead to a loss (itself an
outcome that is rarely well defined \emph{a priori}).  Unsurprisingly,
multiple bridges in our study had been previously audited by third
parties before their attacks.

Our work suggests that by separating overall financial safety
invariants from the intricate details of every given contract or
trade, I can dramatically simplify the defender's job and their
ability to reason about risk.  Similar to so-called ``circuit
breakers'' implemented in traditional securities exchanges, or the
atomic repayment guarantees embedded in single-blockchain ``flash
loan'' services, the ability to script overarching financial
constraints independent of transaction details can be extremely
powerful.  For example, one might extend this work beyond a simple
cross-chain balance invariant to enforce limits on liquidity losses or
to place limits on collateralization risk for tokens backed by
stablecoins.  I hypothesize that by centralizing the specification and
enforcement of \emph{overall} financial constraints in one place, they
will be far easier to audit and reason about.


Chapter~\ref{chap:bridge}, in part, has been submitted for publication of the material as it may appear in Proceedings of the Network and Distributed System Security Symposium 2026. Enze Liu, Elisa Luo, Jian Chen Yan, Katherine Izhikevich, Stewart Grant, Deian Stefan, Geoffrey M. Voelker, and Stefan Savage. The dissertation author was the primary investigator and author of this paper.
% \alex{
% * Bridge support for auditing. 
% * From a design perspective
%     * Whats emitted
%     * Easy indexing?
%     * From a transaparency perspective
%        * What addresses
% * Talk about arichtectural designs and tradeoffs
% * Scenarios in the broader context of bridges (like swap)
% }

% \section{Conclusion}
% In summary, I have empirically shown, by analyzing 20 million
% transactions over 11 bridges and 21 blockchains, that a simple balance
% invariant---checking that value is conserved cross-chain in a bridge
% transaction---is sufficient to identify every such attack I have
% encountered.  Moreover, almost every violation of the balance
% corresponds to a bridge transaction that deserves further manual
% scrutiny (i.e., the ``false positive'' overhead is extremely minimal).
% I show, via proof-of-concept implementations that detection based on
% this principal is cheap to implement and can be performed in
% real-time, either in parallel for the purpose of alerting, or in-line
% to prevent violating transactions from being completed---an approached
% that would have likely foreclosed the \$US2.6B+ in claimed losses from
% prior attacks.  Finally, I argue that accounting-orientated defenses such as ours may be a powerful tool for managing risk in a range of decentralized finance contexts.

% Bridge support for auditing. 
    % From a design perspective
        % Whats emitted
        % Easy indexing?
    % From a transaparency perspective
        % What addresses
    
    % Talk about arichtectural designs and tradeoffs

% Apply scenarios in the broader context of bridges (like swap)


%* no single place with all the bridge contracts (undocumented contract addresse%s)\\
%* relying on external states / third-party api\\
%* internal transaction\\
%* rpc services (internal service, availability, weird corner cases such as arbi%trum)\\
%* talk about the benefits of new architecture (e.g., clear announce as well as %support revert and support advanced debugging / simulation)\\
%* Logs are truncated too for solana (fix 2023) \\
%* Learning based approach for bridge/token behavior?\\
%\subsection{Limitations}
%* I only consider designated withdraw functions. If you withdraw tokens by directly calling Transfer, I cannot detect it. Similarly, if you repurpose other functions (e.g., deposit) for withdrawal, I cannot detect it.\\
%* I only prevent bridge from losing money. Future work can consider adopting the user-centric perspective and model the end-to-end flow by taking into consideration bridge- and token-specific logics.
%* Other attack vectors exist.\\
%\subsection{Counter Measures}





% For example, I only consider designated withdraw functions. If you withdraw tokens by directly calling Transfer, I cannot detect it. Similarly, if you repurpose other functions (e.g., deposit) for withdrawal, I cannot detect it.  I also only prevent the bridge from losing money. Future work can consider adopting the user-centric perspective and model the end-to-end flow by taking into consideration bridge- and token-specific logics.  Finally, other attack vectors exist that are not captured by our approach.  For example, a bridge could be used to launder money by transferring tokens back and forth between two accounts.  While our approach would detect the loss of funds, it would not detect the money laundering.  However, I believe that our approach is a valuable first step in protecting bridges from theft and that it can be extended to address these and other vulnerabilities in the future.
% I only consider designated withdraw functions. If you withdraw tokens by directly calling Transfer, I cannot detect it. Similarly, if you repurpose other functions (e.g., deposit) for withdrawal, I cannot detect it.\\
%* I only prevent bridge from losing money. Future work can consider adopting the user-centric perspective and model the end-to-end flow by taking into consideration bridge- and token-specific logics.
%* Other attack vectors exist.\\



\section{Spyware}

To provide context for our study, I first describe how spyware is
used in general and then describe how I selected the specific spyware
apps I investigate.

\subsection{Spyware Use}

Spyware enables an adversary to surreptitiously record the activities,
behavior, and location of a victim based on the victim's phone usage.
These invasive apps have a wide range of capabilities for
monitoring the victim, and do so using existing Android APIs without
needing root access.

To install these apps, the adversary first creates an account on the spyware's web portal
interface and purchases a subscription, if required.  The adversary then
requires physical access to the victim's device to download and
install the spyware app.  When installing, the app requests an
extensive set of Android permissions as the basis for performing its
monitoring activity.  The adversary readily grants these permissions to
the app, a step which entirely undermines the Android app permission
model.  The adversary then signs in to the app on the device, typically
using the same credentials used by the web portal, and links the
victim's device with the adversary's account on the spyware portal.

Subsequently, the adversary no longer needs physical access to the victim's device, and
can remotely control the actions of the app via the online spyware portal.
The spyware app both passively collects data on the victim's device (e.g.,
location, text messages, calls, etc.), and also allows the adversary to
perform on-demand remote actions like covertly recording audio and
video, taking app screenshots, etc.

Although spyware authors exhibit tremendous effort and creativity in subverting
Android sandbox protections to implement their capabilities, many apps spend
much less effort in protecting the data that they exfiltrate and store on
their backend servers. Later, in Section~\ref{sec:data-leak} I
describe several vulnerabilities in spyware apps that put the victim's
data at risk to a third-party attacker.



\subsection{Spyware App Selection}
\label{subsec:app_selection}

%% Our work focuses on off-store spyware apps since they request
%% a significant number of permissions (from 15 to 53, median 44), implement many
%% privacy-invasive capabilities (Section~\ref{sec:api-abuse}), and do not require root to function. In comparison,
%% apps that are available on the Google Play Store (typically these are apps
%% intended for consensual subordinate tracking of a child or employee) are less
%% likely to request dangerous permissions such as access to the camera, and
%% other permissions highly susceptible to abuse like
%% accessibility~\cite{feal2020angel}.


For our analysis, I chose 14 distinct leading consumer Android spyware
apps.\footnote{Often the same spyware app is available under multiple
  names. I identify and avoid choosing duplicate apps.}  I focus on
Android-based spyware because most of the mobile spyware market
appears to be focused there. Since curated app stores like Google Play do not permit
the sale of such apps, in practice they must be side-loaded off-store, a process
that Apple does not support.  As a result, consumer mobile spyware only operates on ``rooted'' iPhones.  Rooting an iPhone can be a
technically involved operation (one popular guide to jailbreaking the
iPhone involves 41 distinct steps \cite{howToJailbreakIphone:online}) and one that can take significant
time to complete --- both requirements at odds with the broad,
non-technical customer base such apps are marketed to. I also focus on leading spyware apps as they are the apps that more people are exposed to and they are more likely to be innovative (new features could potentially bring them more customers).

In our selection process, I started with the 18 off-store spyware apps identified by Chatterjee et al.~\cite{chatterjee2018spyware}. I augmented our set of apps by taking the intersection of two major industry reports (\cite{esetandr4:online} and~\cite{Tekstalk86:online}) that listed spyware apps.\footnote{We take the intersection of both reports because (a) the definition of consumer spyware is vague; and (b) the collection process is ad-hoc and differs for each report. Apps in the intersection represent consensus among these disparate classifications.} Next, I sorted all the apps based on the Tranco ranking~\cite{pochat2018tranco} of their website domain (snapshot taken on May 5th, 2022).  I filtered out apps that were distributed via Google Play (since, to appear in
the store, they do not have compelling spyware capabilities)
%% apps distributed via Google Play have very limited capabilities
or broken (e.g., not reachable or no longer accepting payments).
%% \alex{One way to avoid mentioning off-store is exlaining why I ignored apps distributed via google store (which is my current version); another option is to squeez in the off-store part somewhere in the intro; }
For apps that are rebranded versions of other apps, I consider them duplicates and did not examine them separately.

From the top 25 most popular apps, I identified 14 distinct apps which I used in our study. The apps in this set are produced by a wide spectrum of vendors, with a broad array of capabilities, and cover the majority of apps identified in prior work~\cite{chatterjee2018spyware} (10 out of the 14 apps that are still alive). Moreover, I find significant overlap in the low-level technical implementation of spyware capabilities:  all but three techniques described in Section~\ref{sec:api-abuse} are discovered after reverse engineering the top five most popular apps (in terms of website domain ranking), and no new techniques are found after the 11th ranked app (Spy24).\footnote{While I do continue to find different variants or implementation of the same technique, I view these as minor details.}
% \alex{added a few words that talks about these apps being sorted}
The lack of new techniques discovered among less popular apps in our set suggests that the apps I study capture a representative set of techniques used in practice.


Table~\ref{tab:apps_selected} shows the list of spyware apps I chose, their website domain and its corresponding Tranco ranking, their web portal domain and its corresponding Tranco ranking, and their APK's target SDK version and package name.

